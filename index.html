<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Matisov X ‚Äî Cyber Samurai</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

:root {
  --neon: #00d2ff;
  --bg: #02040a;
}

* {
  -webkit-tap-highlight-color: transparent;
  user-select: none;
  touch-action: manipulation;
}

body {
  margin: 0;
  background: radial-gradient(circle at 50% 30%, #0b2a44, var(--bg));
  color: #fff;
  font-family: 'Orbitron', sans-serif;
  overflow: hidden;
  height: 100vh;
}

/* –≠—Ñ—Ñ–µ–∫—Ç —Å–µ—Ç–∫–∏ –Ω–∞ –ø–æ–ª—É */
.viewport { position: relative; height: 60vh; overflow: hidden; }
.cyber-floor {
  position: absolute; bottom: -60%; left: -50%;
  width: 200%; height: 200%;
  background:
    linear-gradient(var(--neon) 1px, transparent 1px),
    linear-gradient(90deg, var(--neon) 1px, transparent 1px);
  background-size: 80px 80px;
  opacity: .15; transform: rotateX(70deg);
}

/* –ü–µ—Ä—Å–æ–Ω–∞–∂ */
.hero-wrap {
  position: absolute; bottom: 6%; left: 50%;
  transform: translateX(-50%);
  filter: drop-shadow(0 0 40px var(--neon));
  transition: transform 0.05s;
}
#hero { height: 50vh; animation: idle 3s ease-in-out infinite; }
@keyframes idle { 0%, 100% { transform: translateY(0) } 50% { transform: translateY(-15px) } }

/* –¢–µ–∫—Å—Ç —Ç–∞–ø–∞ */
.tap-text {
  position: absolute; font-size: 2rem; font-weight: 900;
  color: var(--neon); pointer-events: none;
  animation: float .6s forwards; z-index: 100;
  text-shadow: 0 0 10px var(--neon);
}
@keyframes float { to { transform: translateY(-200px) scale(1.5); opacity: 0; } }

/* –ú–µ–Ω—é */
#upgradeMenu {
  position: fixed; inset: 0; background: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(15px); z-index: 100;
  display: none; justify-content: center; align-items: center;
}
.upgrade-panel {
  background: #0b1a2a; border: 1px solid var(--neon); border-radius: 2rem;
  width: 90%; max-width: 450px; padding: 1.5rem; max-height: 85vh; overflow-y: auto;
}
.upgrade-card {
  background: #05111f; padding: 1rem; border-radius: 1.2rem;
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 0.8rem; border: 1px solid rgba(0, 210, 255, 0.1);
}
.upgrade-card button {
  background: var(--neon); color: black; font-weight: bold;
  border-radius: 0.8rem; padding: 0.5rem 1rem; font-size: 0.75rem;
}
.upgrade-card button:disabled { background: #334155; color: #94a3b8; }

.task-item {
  background: rgba(255,255,255,0.03); border: 1px dashed rgba(0,210,255,0.3);
  padding: 0.8rem; border-radius: 1rem; margin-bottom: 0.6rem;
}

/* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
.upgrade-panel::-webkit-scrollbar { width: 4px; }
.upgrade-panel::-webkit-scrollbar-thumb { background: var(--neon); border-radius: 10px; }
</style>
</head>
<body>

<header class="p-6 flex justify-between items-center relative z-10">
  <div onclick="openMenu()" class="cursor-pointer">
    <h1 class="text-xl font-black text-cyan-400">MATISOV X</h1>
    <span class="text-[9px] bg-cyan-900/50 border border-cyan-400/30 px-2 py-0.5 rounded text-cyan-300">MENU</span>
  </div>
  <div class="text-right">
    <div class="text-[10px] text-blue-400 uppercase tracking-widest">Balance</div>
    <div class="text-3xl font-black text-white" id="balDisplay">0</div>
  </div>
</header>

<main class="viewport" id="tapZone">
  <div class="cyber-floor"></div>
  <div class="hero-wrap" id="heroContainer">
    <img id="hero" src="https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/file_0000000008b471f48ebdb6f35b1b1a5a.png">
  </div>
</main>

<div class="px-6 -mt-10 relative z-10">
  <div class="bg-black/60 rounded-3xl p-5 border border-white/5">
    <div class="flex justify-between text-[10px] mb-2 font-bold uppercase tracking-tighter">
      <span class="text-cyan-400">‚ö° Energy Capacity</span>
      <span id="energyText">0 / 0</span>
    </div>
    <div class="h-2 bg-gray-900 rounded-full overflow-hidden">
      <div id="energyBar" class="h-full bg-cyan-400 transition-all duration-300 shadow-[0_0_15px_#00d2ff]"></div>
    </div>
  </div>
</div>

<div id="upgradeMenu">
  <div class="upgrade-panel">
    <h2 class="text-center text-cyan-400 text-xl font-black mb-6 tracking-widest uppercase">Cyber Upgrades</h2>
    
    <div class="space-y-3 mb-8">
      <div class="upgrade-card">
        <div>
          <div class="text-sm font-bold">Cyber Hands</div>
          <div id="handsLevel" class="text-[10px] text-cyan-400">LVL 0</div>
          <div class="text-[9px] opacity-50">+50 Max Energy</div>
        </div>
        <button id="handsBtn" onclick="buyUpgrade('hands')">0 MX</button>
      </div>

      <div class="upgrade-card">
        <div>
          <div class="text-sm font-bold">Sword Power</div>
          <div id="swordLevel" class="text-[10px] text-cyan-400">LVL 0</div>
          <div class="text-[9px] opacity-50">+1 MX per Tap</div>
        </div>
        <button id="swordBtn" onclick="buyUpgrade('sword')">0 MX</button>
      </div>
    </div>

    <h2 class="text-cyan-400 text-xs font-black mb-4 tracking-widest uppercase border-b border-cyan-400/20 pb-1">Real-Time Tasks</h2>
    
    <div id="tasksList" class="space-y-3">
        <div class="task-item flex justify-between items-center">
            <div>
                <div class="text-[10px] font-bold">üì¢ Telegram Channel</div>
                <div class="text-[9px] text-green-400">+3,000,000 MX</div>
            </div>
            <button onclick="doTask(this, 3000000, 'https://t.me/your_channel')" class="bg-cyan-500 text-black text-[9px] px-3 py-1.5 rounded-lg font-bold">GO</button>
        </div>
        <div class="task-item flex justify-between items-center">
            <div>
                <div class="text-[10px] font-bold">üí¨ Telegram Chat</div>
                <div class="text-[9px] text-green-400">+2,000,000 MX</div>
            </div>
            <button onclick="doTask(this, 2000000, 'https://t.me/your_chat')" class="bg-cyan-500 text-black text-[9px] px-3 py-1.5 rounded-lg font-bold">GO</button>
        </div>
        <div class="task-item flex justify-between items-center">
            <div>
                <div class="text-[10px] font-bold">‚ñ∂Ô∏è YouTube Subscribe</div>
                <div class="text-[9px] text-green-400">+2,000,000 MX</div>
            </div>
            <button onclick="doTask(this, 2000000, 'https://youtube.com')" class="bg-cyan-500 text-black text-[9px] px-3 py-1.5 rounded-lg font-bold">GO</button>
        </div>
    </div>

    <button onclick="closeMenu()" class="mt-6 w-full bg-red-500/10 text-red-500 border border-red-500/50 rounded-xl py-3 font-bold text-xs">EXIT MENU</button>
  </div>
</div>

<script>
const TG = window.Telegram.WebApp;
TG.expand();

const UID = TG.initDataUnsafe?.user?.id || "guest";
const KEY = {
  bal: `mx_bal_${UID}`,
  hands: `mx_hnd_${UID}`,
  sword: `mx_swd_${UID}`,
  energy: `mx_ene_${UID}`
};

// State
let state = {
  bal: parseFloat(localStorage.getItem(KEY.bal)) || 0,
  hands: parseInt(localStorage.getItem(KEY.hands)) || 0,
  sword: parseInt(localStorage.getItem(KEY.sword)) || 0,
  e: parseInt(localStorage.getItem(KEY.energy)) || 1000
};

// Helpers
const getMaxEnergy = () => 1000 + (state.hands * 50);
const getTapPower = () => 1 + state.sword;
const getUpgradeCost = (lvl) => Math.floor(1000000 * Math.pow(1.8, lvl));

function formatNum(num) {
    if (num >= 1000000) return (num / 1000000).toFixed(2) + "M";
    return Math.floor(num).toLocaleString();
}

// Logic
function handleTap(x, y) {
    if (state.e <= 0) {
        TG.HapticFeedback.notificationOccurred('error');
        return;
    }

    state.e--;
    const gain = getTapPower();
    state.bal += gain;

    // Visual effect
    const txt = document.createElement("div");
    txt.className = "tap-text";
    txt.style.left = `${x}px`;
    txt.style.top = `${y}px`;
    txt.textContent = `+${gain}`;
    document.body.appendChild(txt);
    setTimeout(() => txt.remove(), 600);

    // Haptic
    TG.HapticFeedback.impactOccurred('medium');
    
    render();
}

// Events
tapZone.addEventListener("touchstart", (e) => {
    e.preventDefault();
    Array.from(e.changedTouches).forEach(t => handleTap(t.clientX, t.clientY));
}, {passive: false});

function buyUpgrade(type) {
    const cost = getUpgradeCost(state[type]);
    if (state.bal >= cost) {
        state.bal -= cost;
        state[type]++;
        TG.HapticFeedback.notificationOccurred('success');
        save();
        render();
    }
}

function doTask(btn, reward, url) {
    TG.openLink(url);
    btn.disabled = true;
    btn.textContent = "WAIT...";
    btn.className = "bg-gray-700 text-gray-400 text-[9px] px-3 py-1.5 rounded-lg font-bold";
    
    setTimeout(() => {
        state.bal += reward;
        btn.textContent = "DONE ‚úÖ";
        btn.className = "bg-green-600 text-white text-[9px] px-3 py-1.5 rounded-lg font-bold";
        TG.HapticFeedback.notificationOccurred('success');
        save();
        render();
    }, 5000);
}

function save() {
    localStorage.setItem(KEY.bal, state.bal);
    localStorage.setItem(KEY.hands, state.hands);
    localStorage.setItem(KEY.sword, state.sword);
    localStorage.setItem(KEY.energy, state.e);
}

function render() {
    const maxE = getMaxEnergy();
    balDisplay.textContent = formatNum(state.bal);
    energyText.textContent = `${state.e} / ${maxE}`;
    energyBar.style.width = (state.e / maxE * 100) + "%";
    
    // Upgrades UI
    const hCost = getUpgradeCost(state.hands);
    handsLevel.textContent = `LVL ${state.hands}`;
    handsBtn.textContent = formatNum(hCost);
    handsBtn.disabled = state.bal < hCost;

    const sCost = getUpgradeCost(state.sword);
    swordLevel.textContent = `LVL ${state.sword}`;
    swordBtn.textContent = formatNum(sCost);
    swordBtn.disabled = state.bal < sCost;
}

function openMenu() { upgradeMenu.style.display = 'flex'; TG.HapticFeedback.impactOccurred('light'); }
function closeMenu() { upgradeMenu.style.display = 'none'; }

// Energy Regen
setInterval(() => {
    const maxE = getMaxEnergy();
    if (state.e < maxE) {
        state.e = Math.min(maxE, state.e + 3);
        render();
    }
    save();
}, 1500);

render();
</script>

</body>
</html>
